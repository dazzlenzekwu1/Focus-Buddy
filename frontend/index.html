<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Focus Buddy</title>
    <link href="https://fonts.googleapis.com/css2?family=Manjari&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Manjari', sans-serif;
            background-color: #f7e9d7;
            color: #4a3e3b;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        h1, h2 {
            font-family: 'Manjari', sans-serif;
        }
        @keyframes fluid-blob {
            0% { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
            50% { border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%; }
            100% { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
        }
        .blob {
            animation: fluid-blob 8s ease-in-out infinite;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <nav class="p-4 bg-transparent w-full flex justify-between items-center z-10">
        <div class="flex items-center space-x-4">
            <h1 class="text-3xl font-bold">Focus Buddy</h1>
        </div>
        <div class="flex items-center space-x-4">
            <a href="index.html" class="px-4 py-2 text-xl font-medium text-gray-700 transition-colors duration-300 rounded-lg hover:text-black">Home</a>
            <a href="timer.html" class="px-4 py-2 text-xl font-medium text-gray-700 transition-colors duration-300 rounded-lg hover:text-black">Timer</a>
            <a href="gallery.html" class="px-4 py-2 text-xl font-medium text-gray-700 transition-colors duration-300 rounded-lg hover:text-black">Fridge</a>
        </div>
    </nav>
    
    <main class="flex-grow flex flex-col items-center justify-center p-4 text-center">
        <div class="relative w-48 h-48 sm:w-64 sm:h-64 mb-8 mx-auto overflow-hidden rounded-full">
            <img src="assets/pastel-blob-magnet.png" alt="Blob Character" class="w-full h-full object-cover transform scale-125 blob">
        </div>
        <h2 class="text-4xl sm:text-6xl font-bold mb-4">Start your focus session.</h2>
        <p class="text-lg sm:text-xl text-gray-600 mb-8 max-w-lg mx-auto">Focus for 25 minutes to unlock a new part of your coloring page.</p>
        <a href="timer.html" class="bg-purple-500 text-white font-bold py-4 px-10 rounded-full text-lg shadow-lg hover:bg-purple-600 transition-colors duration-300">
            Start Focus Session
        </a>
    </main>

    <!-- Display the User ID -->
    <div class="p-4 text-center text-sm text-gray-500">
        <span id="user-id-display">Signing in anonymously...</span>
    </div>

    <!-- Firebase Scripts -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDi2zTx0en5YrvO__EVJ8F2NgzeAp82DAo",
            authDomain: "focus-buddy-1721e.firebaseapp.com",
            projectId: "focus-buddy-1721e",
            storageBucket: "focus-buddy-1721e.firebasestorage.app",
            messagingSenderId: "871273072839",
            appId: "1:871273072839:web:9c91942efa02d84c4616e2",
            measurementId: "G-YB9ZK9JSS3"
        };

        console.log('Initializing Firebase...');

        try {
            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
            console.log('Firebase initialized successfully');

            // Handle initial authentication
            async function authenticate() {
                try {
                    console.log('Attempting anonymous sign-in...');
                    const result = await signInAnonymously(auth);
                    console.log('Anonymous sign-in successful:', result.user.uid);
                } catch (error) {
                    console.error("Firebase Auth Error:", error);
                    console.error("Error code:", error.code);
                    console.error("Error message:", error.message);
                    
                    // Show user-friendly error
                    const userIdDisplay = document.getElementById('user-id-display');
                    if (userIdDisplay) {
                        userIdDisplay.textContent = `Auth Error: ${error.message}`;
                        userIdDisplay.style.color = 'red';
                    }
                }
            }

            // Listen for authentication state changes and display the user ID
            onAuthStateChanged(auth, (user) => {
                console.log('Auth state changed:', user ? 'User signed in' : 'User signed out');
                const userIdDisplay = document.getElementById('user-id-display');
                if (userIdDisplay) {
                    if (user) {
                        userIdDisplay.textContent = `User ID: ${user.uid}`;
                        userIdDisplay.style.color = 'green';
                    } else {
                        userIdDisplay.textContent = `Signing in anonymously...`;
                        userIdDisplay.style.color = 'gray';
                    }
                }
            });

            // Run the authentication function
            authenticate();

        } catch (error) {
            console.error('Firebase initialization error:', error);
            const userIdDisplay = document.getElementById('user-id-display');
            if (userIdDisplay) {
                userIdDisplay.textContent = `Firebase Error: ${error.message}`;
                userIdDisplay.style.color = 'red';
            }
        }
    </script>

</body>
</html>

